<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BluejayPro Attendance Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background-color: #f4f8ff; color: #333; }

        /* Card style container for form */
        .card {
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            max-width: 700px;
            margin: auto;
        }

        table { border-collapse: collapse; width: 100%; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #007bff; color: #fff; }

        form div { margin-bottom: 10px; }
        label { display: inline-block; width: 120px; }
        input[type="text"], input[type="url"], input[type="time"], textarea, select {
            width: 200px;
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        button {
            background-color: #007bff;
            border: none;
            color: #fff;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        /* Row highlighting */
        .present { background-color: #d4edda; }
        .absent { background-color: #f8d7da; }
    </style>
</head>
<body>
    <h1>BluejayPro Attendance Tracker</h1>
    <div class="card">
    <form id="attendanceForm">
        <div>
            <label for="employee">Employee:</label>
            <select id="employee" required>
                <option value="" disabled selected>Select employee</option>
                <option value="Alice">Alice</option>
                <option value="Bob">Bob</option>
                <option value="Charlie">Charlie</option>
            </select>
        </div>
        <div>
            <label for="status">Status:</label>
            <select id="status" required>
                <option value="" disabled selected>Select status</option>
                <option value="Present">Present</option>
                <option value="Absent">Absent</option>
            </select>
        </div>
        <div>
            <label for="notes">Notes:</label>
            <textarea id="notes" rows="2" cols="30"></textarea>
        </div>
        <div>
            <label for="summary">Work Summary:</label>
            <input type="text" id="summary" required>
        </div>
        <div>
            <label for="excel">Excel File Link:</label>
            <input type="url" id="excel" required>
        </div>
        <div>
            <label for="timein">Time In:</label>
            <input type="time" id="timein" required>
        </div>
        <div>
            <label for="timeout">Time Out:</label>
            <input type="time" id="timeout" required>
        </div>
        <button type="submit">Add Entry</button>
    </form>
    </div>

    <div class="card">
    <table id="attendanceTable">
        <thead>
            <tr>
                <th>Date</th>
                <th>Employee</th>
                <th>Status</th>
                <th>Notes</th>
                <th>Work Summary</th>
                <th>Excel Link</th>
                <th>Time In</th>
                <th>Time Out</th>
            </tr>
        </thead>
        <tbody>
            <!-- entries will be added here -->
        </tbody>
    </table>
    </div>

    <script>
    // get references to the form and table body
    const form = document.getElementById('attendanceForm');
    const tableBody = document.querySelector('#attendanceTable tbody');

    // helper function to format date and time as YYYY-MM-DD HH:MM
    function formatDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        const hours = String(date.getHours()).padStart(2, '0');
        const minutes = String(date.getMinutes()).padStart(2, '0');
        return `${year}-${month}-${day} ${hours}:${minutes}`;
    }

    // listen for form submission
    form.addEventListener('submit', function(event) {
        event.preventDefault(); // prevent the page from refreshing

        // collect values from the form
        const employee = document.getElementById('employee').value;
        const status = document.getElementById('status').value;
        const notes = document.getElementById('notes').value;
        const summary = document.getElementById('summary').value;
        const excel = document.getElementById('excel').value;
        const timein = document.getElementById('timein').value;  // new "Time In" field
        const timeout = document.getElementById('timeout').value;

        // create a new row, applying a style based on the status
        const row = document.createElement('tr');

        // highlight row color based on attendance status
        if (status === 'Present') {
            row.classList.add('present');
        } else if (status === 'Absent') {
            row.classList.add('absent');
        }

        // first cell is the current date and time
        const dateCell = document.createElement('td');
        dateCell.textContent = formatDate(new Date());
        row.appendChild(dateCell);

        // add the rest of the data to the row
        const employeeCell = document.createElement('td');
        employeeCell.textContent = employee;
        row.appendChild(employeeCell);

        const statusCell = document.createElement('td');
        statusCell.textContent = status;
        row.appendChild(statusCell);

        const notesCell = document.createElement('td');
        notesCell.textContent = notes;
        row.appendChild(notesCell);

        const summaryCell = document.createElement('td');
        summaryCell.textContent = summary;
        row.appendChild(summaryCell);

        const linkCell = document.createElement('td');
        const link = document.createElement('a');
        link.href = excel;
        link.textContent = 'Excel File';
        link.target = '_blank'; // keep file link opening in new tab
        linkCell.appendChild(link);
        row.appendChild(linkCell);

        const timeInCell = document.createElement('td');
        timeInCell.textContent = timein;
        row.appendChild(timeInCell);

        const timeCell = document.createElement('td');
        timeCell.textContent = timeout;
        row.appendChild(timeCell);

        // add the row to the table
        tableBody.appendChild(row);

        // clear the form for the next entry
        form.reset();
    });
    </script>
</body>
</html>
